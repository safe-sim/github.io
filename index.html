<!DOCTYPE html>
<html>
<head>
  <meta charset="utf-8">
  <meta name="description"
        content="SAFE-SIM: Safety-Critical Closed-Loop Traffic Simulation with Controllable Adversaries">
  <meta name="viewport" content="width=device-width, initial-scale=1">
  <title>SAFE-SIM: Safety-Critical Closed-Loop Traffic Simulation with Diffusion-Controllable Adversaries</title>
  <!-- Global site tag (gtag.js) - Google Analytics -->
  <script async src="https://www.googletagmanager.com/gtag/js?id=G-PYVRSFMDRL"></script>
  <script>
    window.dataLayer = window.dataLayer || [];

    function gtag() {
      dataLayer.push(arguments);
    }

    gtag('js', new Date());

    gtag('config', 'G-PYVRSFMDRL');
  </script>

  <link href="https://fonts.googleapis.com/css?family=Google+Sans|Noto+Sans|Castoro"
        rel="stylesheet">

  <link rel="stylesheet" href="./static/css/bulma.min.css">
  <link rel="stylesheet" href="./static/css/bulma-carousel.min.css">
  <link rel="stylesheet" href="./static/css/bulma-slider.min.css">
  <link rel="stylesheet" href="./static/css/fontawesome.all.min.css">
  <link rel="stylesheet"
        href="https://cdn.jsdelivr.net/gh/jpswalsh/academicons@1/css/academicons.min.css">
  <link rel="stylesheet" href="./static/css/index.css">

  <script src="https://ajax.googleapis.com/ajax/libs/jquery/3.5.1/jquery.min.js"></script>
  <script defer src="./static/js/fontawesome.all.min.js"></script>
  <script src="./static/js/bulma-carousel.min.js"></script>
  <script src="./static/js/bulma-slider.min.js"></script>
  <script src="./static/js/index.js"></script>
</head>
<body>


  <section class="hero">
    <div class="hero-body">
      <div class="container is-max-desktop">
        <div class="columns is-centered">
          <div class="column has-text-centered">
            <h1 class="title is-1 publication-title">SAFE-SIM: Safety-Critical Closed-Loop Traffic Simulation with Diffusion-Controllable Adversaries</h1>
            <div class="is-size-5 publication-authors">
              <span class="author-block">
                <span><a href="https://scholar.google.com/citations?user=tF-OmYgAAAAJ&hl=en">Wei-Jer Chang</span><sup>1</sup>,</span>
              <span class="author-block">
                <span><a href="https://www.francescopittaluga.com/"></span><sup>2</sup>,</span>
              <span class="author-block"> 
                <span><a href="https://me.berkeley.edu/people/masayoshi-tomizuka/"></a>Masayoshi Tomizuka</span><sup>1</sup>,</span>
              <span class="author-block">
                <span<a href="https://zhanwei.site/"></span><sup>1</sup>,</span>
              <span class="author-block">  
                <span><a href="https://cseweb.ucsd.edu/~mkchan"></a>Manmohan Chandraker</span><sup>2,3</sup>
              </span>
            </div>
  
            <div class="is-size-5 publication-authors">
              <span class="author-block"><sup>1</sup>University of California Berkeley,</span>
              <span class="author-block"><sup>2</sup>NEC Labs America,</span>
              <span class="author-block"><sup>3</sup>University of California San Diego</span>
          </div>
    

          <div class="column has-text-centered">
            <div class="publication-links">
              <!-- PDF Link. -->
              <span class="link-block">
                <a href="https://arxiv.org/abs/2401.00391"
                   class="external-link button is-normal is-rounded is-dark">
                  <span class="icon">
                      <i class="fas fa-file-pdf"></i>
                  </span>
                  <span>Paper</span>
                </a>
              <!-- Arxiv Link. -->
              </span>
              <span class="link-block">
                <a href="https://arxiv.org/abs/2401.00391"
                   class="external-link button is-normal is-rounded is-dark">
                  <span class="icon">
                      <i class="ai ai-arxiv"></i>
                  </span>
                  <span>arXiv</span>
                </a>
              </span>
              <!-- Code Link. -->
              <span class="link-block">
                <!-- TODO modify to actual code in the future -->
                <a href="https://safe-sim.github.io/" 
                   class="external-link button is-normal is-rounded is-dark">
                  <span class="icon">
                      <i class="fab fa-github"></i>
                  </span>
                  <span>Code</span>
                  </a>
              </span>
            </div>
          </div>
        </div>
      </div>
    </div>
  </div>
</section>




<section class="section">
  <div class="container is-max-desktop">
    <!-- Abstract. -->
    <div class="columns is-centered has-text-centered">
      <div class="column is-four-fifths">
        <h2 class="title is-3">Abstract</h2>
        <div class="content has-text-justified">
          <p>
            Evaluating the performance of autonomous vehicle planning algorithms necessitates simulating long-tail safety-critical traffic scenarios. However, traditional methods for generating such scenarios often fall short in terms of controllability and realism; they also neglect the dynamics of agent interactions. To address these limitations, we introduce \safesim, a novel diffusion-based controllable closed-loop safety-critical simulation framework. Our approach yields two distinct advantages: 1) generating realistic long-tail safety-critical scenarios that closely reflect real-world conditions, and 2) providing controllable adversarial behavior for more comprehensive and interactive evaluations. We develop a novel approach to simulate safety-critical scenarios through an adversarial term in the denoising process of diffusion models, which allows an adversarial agent to challenge a planner with plausible maneuvers while all agents in the scene exhibit reactive and realistic behaviors. Furthermore, we propose novel guidance objectives and a partial diffusion process that enables users to control key aspects of the scenarios, such as the collision type and aggressiveness of the adversarial agent, while maintaining the realism of the behavior. We validate our framework empirically using the nuScenes and nuPlan datasets across multiple planners, demonstrating improvements in both realism and controllability. These findings affirm that diffusion models provide a robust and versatile foundation for safety-critical, interactive traffic simulation, extending their utility across the broader autonomous driving landscape. 
        </div>
      </div>
    </div>
    <!--/ Abstract. -->

    <!-- Paper video. -->
    <!-- Paper video. -->
  <div class="columns is-centered has-text-centered">
    <div class="column is-four-fifths">
      <h2 class="title is-3">Video</h2>
      <div class="publication-video">
        <video controls width="560" height="315">
          <source src="./static/videos/safe_sim.mp4" type="video/mp4">
          Your browser does not support the video tag.
        </video>
      </div>
    </div>
  </div>

</section>


<!-- TTC -->
<section class="section">
  <div class="container is-max-desktop">
    <div class="columns is-centered has-text-centered">
      <!-- Figure (PDF) -->
      <div class="column is-full-width">
        <embed src="./static/figures/main_framework.pdf" type="application/pdf" width="100%" height="500px" />
      </div>
      <!-- Text under the figure -->
      <div class="column is-full-width">
        <div class="content has-text-justified">
          <p>
            We can also animate the scene by interpolating the deformation latent codes of two input
            frames. Use the slider here to linearly interpolate between the left frame and the right
            frame.
          </p>
        </div>
      </div>

      <!-- Legend and TTC Header and Bar -->
      <div class="column is-full-width">
        <img src="./static/images/legend.png" alt="Legend" width="200px" style="margin-bottom: 20px;">
        <div class="columns is-vcentered has-text-centered">
          <div class="column">
            <h3 class="title is-5">TTC Low</h3>
          </div>
          <div class="column is-4">
            <progress class="progress is-large" value="50" max="100" style="height: 5px;"></progress>
          </div>
          <div class="column">
            <h3 class="title is-5">TTC High</h3>
          </div>
        </div>
      </div>

      <!-- Videos -->
      <div class="column is-full-width">
        <div class="columns is-vcentered">
          <div class="column is-one-third has-text-centered">
            <h3 class="title is-4">T-Bone</h3>
            <video width="100%" controls>
              <source src="./static/videos/TTC_scene-0638_1.mp4" type="video/mp4">
              Your browser does not support the video tag.
            </video>
          </div>
          <div class="column is-one-third has-text-centered">
            <h3 class="title is-4">Side</h3>
            <video width="100%" controls>
              <source src="./static/videos/TTC_scene-0638_2.mp4" type="video/mp4">
              Your browser does not support the video tag.
            </video>
          </div>
          <div class="column is-one-third has-text-centered">
            <h3 class="title is-4">Front</h3>
            <video width="100%" controls>
              <source src="./static/videos/TTC_scene-0638_3.mp4" type="video/mp4">
              Your browser does not support the video tag.
            </video>
          </div>
        </div>
      </div>
    </div>
  </div>
</section>

<section class="section" id="BibTeX">
  <div class="container is-max-desktop content">
    <h2 class="title">BibTeX</h2>
    <pre><code>@misc{chang2023controllable,
      title={Controllable Safety-Critical Closed-loop Traffic Simulation via Guided Diffusion}, 
      author={Wei-Jer Chang and Francesco Pittaluga and Masayoshi Tomizuka and Wei Zhan and Manmohan Chandraker},
      year={2023},
      eprint={2401.00391},
      archivePrefix={arXiv},
      primaryClass={cs.RO}
}</code></pre>
  </div>
</section>

<footer class="footer">
  <div class="container">
    <div class="columns is-centered">
      <div class="column is-8">
        <div class="content">
          <p>
            The template is borrowed from <a
            href="https://github.com/nerfies/nerfies.github.io">source code</a>
          </p>
        </div>
      </div>
    </div>
    <div class="columns is-centered">
      <div class="column is-8">
        <div class="content">
          <p>
            Contact<br>
            For any questions, please contact Wei-Jer Chang at <a href="mailto:weijer_chang@berkeley.edu">weijer_chang@berkeley.edu</a>.
          </p>
        </div>
      </div>
    </div>
  </div>
</footer>
